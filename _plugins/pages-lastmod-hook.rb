#!/usr/bin/env ruby
#
# Check for changed posts

Jekyll::Hooks.register :pages, :post_init do |page|

    puts page.path
    commit_num = `test -f "#{ page.path }" && git rev-list --count HEAD "#{ page.path }"`

    if commit_num.to_i > 1
      lastmod_date = `git log -1 --pretty="%ad" --date=iso "#{ page.path }"`
      page.data['last_modified_at'] = lastmod_date
      page.data['last_modified_date'] = lastmod_date      
    end
  
  end