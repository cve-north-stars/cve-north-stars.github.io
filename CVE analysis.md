# CVE Analysis

CVE analysis is one **road** of many that can lead to the identification of [vulnerability classes](Vulnerability%20Classes.md) and comprehension. 
![](Resources/images/tom-gainor-wz1ekVwnlRY-unsplash.jpg)


> A **vulnerability class** is a set of vulnerabilities that share some unifying commonality pattern or concept that isolates a specific feature shared by several different software flaws

The analysis of the CVE will grant experience with the specific component that contains the reported vulnerability. As the component in analyzed, it will highlight the current problem and help put you in the context to identify the same problem in in the same component, or within other components within the system. 

The analysis of several CVEs within the same software can help to generalize vulnerability classes withing the system.  To help with the process, a template is provided. 


## CVE Analysis Template

```
tags: #cve-analysis

- metadata
	- CVE #:  
	- Related CWE(s):
	- Related CVE(s):
	- created: 2021-01-29
	- title:
	- web:  
	- platform:
	- descriptor tags: #cve #security 


# CVE-####-####

## Summary

## Components affected

## Security Boundaries 
*which [security boundaries](https://www.microsoft.com/en-us/msrc/windows-security-servicing-criteria) have been crossed? **

## Requirements
*what stars needed to align?*

## CVE Root Cause

### Best Fit Vulnerability Class (or CWE) for *this* CVE

### Was this CVE the Root Cause or a Causal Factor?

Choose **one**:
- **root cause** - *underlying issue or fundamental reason of a problem or issue*
- **causal factor** - *major contributor to an undeseriable conditioon that if eliminated, would have either prevented the occurence of the incident or reduced its severity or frequency*

## Patch Info


```

### Why use a template?  #develop
1. Analyze several CVEs to see what vulnerability classes are lurking in the software you are researching. 
2. Standardize the way you are looking at CVEs for efficiency and the ability to start to identify patterns.  
	1. Google recently did this with Root Cause Analysis Template


### Metadata Primer
*data about your data providing context for the CVE*

- **CVE #**:  < CVE-YYYY-#### > 		
- **Related CWE(s)**: <Related Vulnerability Classifications. This is not required, but useful when trying to see patterns.>
-** Related CVE(s)**: < list of CVEs that relate to this instance >
- **created**: 2021-01-29
- **title**: < self created of internet deemed title>
- **web**:  < list of reference blog links for your  >
- **platform**: < Windows/Android/ios/etc >
- **descriptor tags**: < \#hastagsToDescribeCVE >

### CWEs??

CWE stands for **common weakness enumeration**.  Yet another community list helping to identify and categorize vulnerabilities. The easiest way to explain the difference is to contrast CWE with CVE. 

A CVE (**common vulnerability and exposure**) is an instance of a particular vulnerability. (ie CVE-2020-1048)  A CWE (**common weakness enumeration**) is the category that a vulnerability fits in, or it's type or [vulnerability class](Vulnerability%20Classes.md).

Also, see [CWE - Common Weakness Enumeration](CWE%20-%20Common%20Weakness%20Enumeration.md) for more details. 


### Several Roads to Rome

There are alternate templates.  In July of 2020 Googe's Project zero created there own template.  They also keep a spreadsheet to summarize their findings across the years. See [[Google's Project Zero Template]].  What is most important is that you have a template that works for you. 


## Example analysis

Following along from our [research](Research.md), we will continue looking at CVEs from the Windows Print Spooler.  

This list was pulled in Jan 2021 searching "Windows Print Spooler" (mostly*):

|Name|Description|
|--- |--- |
|[CVE-2021-1678](CVE-2021-1678.md)|*NTLM Security Feature Bypass Vulnerability*| 
|CVE-2021-1695|Windows Print Spooler Elevation of Privilege Vulnerability|
|CVE-2020-17042|Windows Print Spooler Remote Code Execution Vulnerability|
|CVE-2020-17014|Windows Print Spooler Elevation of Privilege Vulnerability This CVE ID is unique from CVE-2020-17001.|
|[CVE-2020-17001](CVE-2020-17001.md)|Windows Print Spooler Elevation of Privilege Vulnerability This CVE ID is unique from CVE-2020-17014.|
|CVE-2020-1337|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'.|
|CVE-2020-1070|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'. This CVE ID is unique from CVE-2020-1048.|
|CVE-2020-1048|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'. This CVE ID is unique from CVE-2020-1070.|
|CVE-2020-1030|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'.|
|CVE-2019-0759|An information disclosure vulnerability exists when the Windows Print Spooler does not properly handle objects in memory, aka 'Windows Print Spooler Information Disclosure Vulnerability'.|
|CVE-2016-3239|The Print Spooler service in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows local users to gain privileges via vectors involving filesystem write operations, aka "Windows Print Spooler Elevation of Privilege Vulnerability."|
|CVE-2016-3238|The Print Spooler service in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows man-in-the-middle attackers to execute arbitrary code by providing a crafted print driver during printer installation, aka "Windows Print Spooler Remote Code Execution Vulnerability."|
|CVE-2013-1339|The Print Spooler in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows Server 2012, and Windows RT does not properly manage memory during deletion of printer connections, which allows remote authenticated users to execute arbitrary code via a crafted request, aka "Print Spooler Vulnerability."|
|CVE-2013-0011|The Print Spooler in Microsoft Windows Server 2008 R2 and R2 SP1 and Windows 7 Gold and SP1 allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption) via a crafted print job, aka "Windows Print Spooler Components Vulnerability."|
|CVE-2012-1851|Format string vulnerability in the Print Spooler service in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote attackers to execute arbitrary code via a crafted response, aka "Print Spooler Service Format String Vulnerability."|
|CVE-2010-2729|The Print Spooler service in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7, when printer sharing is enabled, does not properly validate spooler access permissions, which allows remote attackers to create files in a system directory, and consequently execute arbitrary code, by sending a crafted print request over RPC, as exploited in the wild in September 2010, aka "Print Spooler Service Impersonation Vulnerability."|
|CVE-2009-0230|The Windows Print Spooler in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP2, Vista Gold, SP1, and SP2, and Server 2008 SP2 allows remote authenticated users to gain privileges via a crafted RPC message that triggers loading of a DLL file from an arbitrary directory, aka "Print Spooler Load Library Vulnerability."|
|CVE-2009-0229|The Windows Printing Service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP2, Vista Gold, SP1, and SP2, and Server 2008 SP2 allows local users to read arbitrary files via a crafted separator page, aka "Print Spooler Read File Vulnerability."|
|CVE-2009-0228|Stack-based buffer overflow in the EnumeratePrintShares function in Windows Print Spooler Service (win32spl.dll) in Microsoft Windows 2000 SP4 allows remote printer servers to execute arbitrary code via a crafted ShareName in a response to an RPC request, related to "printing data structures," aka "Buffer Overflow in Print Spooler Vulnerability."|
|CVE-2006-6296|The RpcGetPrinterData function in the Print Spooler (spoolsv.exe) service in Microsoft Windows 2000 SP4 and earlier, and possibly Windows XP SP1 and earlier, allows remote attackers to cause a denial of service (memory consumption) via an RPC request that specifies a large 'offered' value (output buffer size), a variant of CVE-2005-3644.|
|CVE-2005-1984|Buffer overflow in the Print Spooler service (Spoolsv.exe) for Microsoft Windows 2000, Windows XP, and Windows Server 2003 allows remote attackers to execute arbitrary code via a malicious message.|
|CVE-2001-1451|Memory leak in the SNMP LAN Manager (LANMAN) MIB extension for Microsoft Windows 2000 before SP3, when the Print Spooler is not running, allows remote attackers to cause a denial of service (memory consumption) via a large number of GET or GETNEXT requests.|
|CVE-1999-0899|The Windows NT 4.0 print spooler allows a local user to execute arbitrary commands due to inappropriate permissions that allow the user to specify an alternate print provider.|
|CVE-1999-0898|Buffer overflows in Windows NT 4.0 print spooler allow remote attackers to gain privileges or cause a denial of service via a malformed spooler request.|
* Note: This list includes an entry in *italics* not found within the CVE database, or rather not linked to the Windows Print Spooler. While this list is effective, it is not comprehensive. Rather found from security blogs and linked to the Windows Print Spooler. 


From  repeated CVE analysis you can begin to understand the complexity of this system. The entry points and attack surface.  And start to identify the problem areas. From the **CVE requirements** section of the templates, some patterns being to emerge. 

### Insight / Patterns / Hot Spots

### Getting to the Root Cause





There is no such thing as a perfect analysis.  There may not be enough information, blogs, or documentation for the deepest understand.  It's ok to not fill in the template completely.  That is when we will take a look at [Patch Analysis](Patch%20Analysis.md) to hopefully fill in some of the gaps.  Before we get there, let's take a look at [Environment Setup and Tooling](Environment%20Setup%20and%20Tooling.md). 