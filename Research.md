# Research
![](Resources/images/steve-halama-cpNN9nxx6Ck-unsplash.jpg)
[](https://unsplash.com/photos/cpNN9nxx6Ck)

The research portion of any project is critical. Itâ€™s a time to immerse yourself into the relevant research literature in order to define a problem that is both relevant and tractable.  This research section describes a method to identify and collect relevant CVEs and related information for a selected platform and software component. 

## Identify Platform
These series of steps, at a high level, are platform independent. However, the platform choice will have several implications as to environment setup and tools used for analysis. In addition, the security update process is unique per platform and a high level understanding of the process will be necessary to complete [Patch Analysis](Patch%20Analysis.md). Discovering how to get system binaries and patched versions of those same binaries will vary. This article follows a **Windows** path.

## Identify CVEs

### CVEs

The Common Vulnerability and Exposures (CVE) is a list of particular instances (CVE IDs) of reported vulnerabilities maintained by [MITRE](https://en.wikipedia.org/wiki/Mitre_Corporation). 

A CVE *identifier*  (CVE ID) at the time of this writing is defined as: 

**\[CVE prefix + Year + Arbitrary Digits\]**

Examples include: 
- CVE-2020-1048
- CVE-2017-11201

Each CVE contains:
- *CVE Identifier* - to uniquely identify the vulnerability
- *Brief Description* 
	- to provide an understanding of the vulnerability
	- Including at least **one** of the following:
		- Vulnerability Type - (RCE,EoP,etc)
		- Root Cause
		- Impact
- *References* - a publicly available external reference

See [CVE Numbering Authority (CNA) Rules](https://cve.mitre.org/cve/cna/rules.html#section_8-2_cve_entry_prose_description_requirements) for further details.

### Where to Find Them 

The easiest method to find CVEs is to go to the [source](https://cve.mitre.org/cve/) From there, search for a particular CVE ID or keywords like "**Windows Print Spooler**" or "**Chrome Use After Free**"".  This list provides the short description and some external reference that *might* be useful. 

| CVE-ID | CVE-2020-1048 |
|---|---|
|Description| An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'. This CVE ID is unique from CVE-2020-1070.|
|References| [MISC:http://packetstormsecurity.com/files/158222/Windows-Print-Spooler-Privilege-Escalation.html](http://packetstormsecurity.com/files/158222/Windows-Print-Spooler-Privilege-Escalation.html) - [MISC:http://packetstormsecurity.com/files/159217/Microsoft-Spooler-Local-Privilege-Elevation.html](http://packetstormsecurity.com/files/159217/Microsoft-Spooler-Local-Privilege-Elevation.html) - [MISC:https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1048](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1048)|
|Assigning CNA|Microsoft Corporation|
|Date Record Created|**20191104**|
[Source](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1048)

Often, the *references* only provide shallow information, similar to the short description provided in the CVE link itself.  Leveraging the CVE list a more of a 'fact of' list, it's best then to go search for the CVE ID directly and find related blogs which provide more depth. If no blogs exist, which is often the case, don't worry.  See [Patch Analysis](Patch%20Analysis.md)

List of other good sources:
- Google (obviously)
- [Reddit - r/netsec](https://www.reddit.com/r/netsec/)
- [Project Zero](https://bugs.chromium.org/p/project-zero/issues/list)
- [Github](https://github.com/search?q=cve-2020-2048)
- [Twitter](https://twitter.com/search?q=cve-2020-2048)

### Finding CVEs of Interest

Finding *CVEs of interest* is subjective. Certain vulnerability classes might be of interest to a researcher because of familiarity or personal preference. Some objective reasons to consider are:
- *availability* - whether or not enough information is available to get started.  When a new bug class or high profile vulnerability is disclosed, there are often several blog posts and articles detailing the specifics of the vulnerability. 
- *goals* - depth of breadth? broadening horizons or laser focusing on a specific vulnerability class? or mapping out a specific software/system component?

This article is influenced by recent *availability* of Windows Printer Spooler reports as this topic has recently been quite popular.

### CVE Topical Searches

As mentioned before, searching for CVEs is trivial.  Head on over to Mitre's page https://cve.mitre.org. For example. Searching for "Windows Print Spooler" reveals the following table: *https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=windows+print+spooler*

|Name|Description|
|--- |--- |
|CVE-2021-1695|Windows Print Spooler Elevation of Privilege Vulnerability|
|CVE-2020-17042|Windows Print Spooler Remote Code Execution Vulnerability|
|CVE-2020-17014|Windows Print Spooler Elevation of Privilege Vulnerability This CVE ID is unique from CVE-2020-17001.|
|[CVE-2020-17001](CVE-2020-17001.md)|Windows Print Spooler Elevation of Privilege Vulnerability This CVE ID is unique from CVE-2020-17014.|
|[CVE-2020-1337](CVE-2020-1337.md)|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'.|
|CVE-2020-1070|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'. This CVE ID is unique from CVE-2020-1048.|
|[CVE-2020-1048](CVE-2020-1048.md)|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'. This CVE ID is unique from CVE-2020-1070.|
|CVE-2020-1030|An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system, aka 'Windows Print Spooler Elevation of Privilege Vulnerability'.|
|CVE-2019-0759|An information disclosure vulnerability exists when the Windows Print Spooler does not properly handle objects in memory, aka 'Windows Print Spooler Information Disclosure Vulnerability'.|
|CVE-2016-3239|The Print Spooler service in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows local users to gain privileges via vectors involving filesystem write operations, aka "Windows Print Spooler Elevation of Privilege Vulnerability."|
|CVE-2016-3238|The Print Spooler service in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows man-in-the-middle attackers to execute arbitrary code by providing a crafted print driver during printer installation, aka "Windows Print Spooler Remote Code Execution Vulnerability."|
|CVE-2013-1339|The Print Spooler in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows Server 2012, and Windows RT does not properly manage memory during deletion of printer connections, which allows remote authenticated users to execute arbitrary code via a crafted request, aka "Print Spooler Vulnerability."|
|CVE-2013-0011|The Print Spooler in Microsoft Windows Server 2008 R2 and R2 SP1 and Windows 7 Gold and SP1 allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption) via a crafted print job, aka "Windows Print Spooler Components Vulnerability."|
|CVE-2012-1851|Format string vulnerability in the Print Spooler service in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote attackers to execute arbitrary code via a crafted response, aka "Print Spooler Service Format String Vulnerability."|
|[CVE-2010-2729](CVE-2010-2729.md)|The Print Spooler service in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7, when printer sharing is enabled, does not properly validate spooler access permissions, which allows remote attackers to create files in a system directory, and consequently execute arbitrary code, by sending a crafted print request over RPC, as exploited in the wild in September 2010, aka "Print Spooler Service Impersonation Vulnerability."|
|CVE-2009-0230|The Windows Print Spooler in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP2, Vista Gold, SP1, and SP2, and Server 2008 SP2 allows remote authenticated users to gain privileges via a crafted RPC message that triggers loading of a DLL file from an arbitrary directory, aka "Print Spooler Load Library Vulnerability."|
|CVE-2009-0229|The Windows Printing Service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP2, Vista Gold, SP1, and SP2, and Server 2008 SP2 allows local users to read arbitrary files via a crafted separator page, aka "Print Spooler Read File Vulnerability."|
|CVE-2009-0228|Stack-based buffer overflow in the EnumeratePrintShares function in Windows Print Spooler Service (win32spl.dll) in Microsoft Windows 2000 SP4 allows remote printer servers to execute arbitrary code via a crafted ShareName in a response to an RPC request, related to "printing data structures," aka "Buffer Overflow in Print Spooler Vulnerability."|
|CVE-2006-6296|The RpcGetPrinterData function in the Print Spooler (spoolsv.exe) service in Microsoft Windows 2000 SP4 and earlier, and possibly Windows XP SP1 and earlier, allows remote attackers to cause a denial of service (memory consumption) via an RPC request that specifies a large 'offered' value (output buffer size), a variant of CVE-2005-3644.|
|CVE-2005-1984|Buffer overflow in the Print Spooler service (Spoolsv.exe) for Microsoft Windows 2000, Windows XP, and Windows Server 2003 allows remote attackers to execute arbitrary code via a malicious message.|
|CVE-2001-1451|Memory leak in the SNMP LAN Manager (LANMAN) MIB extension for Microsoft Windows 2000 before SP3, when the Print Spooler is not running, allows remote attackers to cause a denial of service (memory consumption) via a large number of GET or GETNEXT requests.|
|CVE-1999-0899|The Windows NT 4.0 print spooler allows a local user to execute arbitrary commands due to inappropriate permissions that allow the user to specify an alternate print provider.|
|CVE-1999-0898|Buffer overflows in Windows NT 4.0 print spooler allow remote attackers to gain privileges or cause a denial of service via a malformed spooler request.|


## Seeking Patterns
![](Resources/images/isaac-quesada-W7Y3WqAMVig-unsplash.jpg) [](https://unsplash.com/photos/W7Y3WqAMVig)

Finding patterns and vulnerability classes takes time. Reviewing several CVEs for a particular piece of software should help connect the dots by defining the requirements needed to enact the vulnerabilities. The more you can observe, the more likely a pattern will emerge.  As you being to become familiar with a particular software component, it will be easier to notice the security relevant areas of the software. 

Simply reviewing the CVE table's text can give you some hint without looking any further. You can see that this is a Windows **service**, likely running at an **elevated** **privelege**, accessible by **RPC** and able to **write** **arbitrary** **files**. 


![](Resources/images/cve_print_spooler_word_art.png)

*Result of dumping the above text in [a word art generator](https://tagcrowd.com/)*

To dig a little deeper, we will move onto the next section detailing [CVE analysis](CVE%20analysis.md). 



